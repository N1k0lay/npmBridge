# Project Brief: npmBridge

## Обзор

**npmBridge** — веб-интерфейс для управления локальным NPM-репозиторием на базе Verdaccio. Предназначен для кеширования пакетов из интернета и последующего переноса в изолированные корпоративные сети (air-gapped environments).

## Основная цель

Решение проблемы обновления npm-пакетов в корпоративных сетях без прямого доступа к интернету:

```
ИНТЕРНЕТ → Сервер с npmBridge (с интернетом) → Корпоративная сеть (без интернета)
```

## Ключевые требования

### Функциональные

1. **Кеширование пакетов** через Verdaccio (прокси к registry.npmjs.org)
2. **Обновление пакетов** до latest версий — полное и инкрементальное (недавние)
3. **Создание diff-архивов** — только изменения с момента последнего переноса
4. **Поддержка нескольких корпоративных сетей** — раздельное отслеживание переноса
5. **Проверка целостности** архивов `.tgz` и автоматическое исправление
6. **Storage Browser** — просмотр содержимого репозитория
7. **История пакетов** — хронология появления версий

### Нефункциональные

- Запуск через Docker Compose (единая точка входа)
- Веб-интерфейс доступен на порту 4013
- Verdaccio доступен на порту 4873
- Хранение состояния в SQLite (no external DB)
- Python-скрипты для тяжёлых операций (обновление, diff, проверка)

## Директории хранения

| Директория | Назначение |
|-----------|-----------|
| `storage/` | Актуальный кеш пакетов Verdaccio |
| `frozen/` | Снимок состояния после последнего переноса (для diff) |
| `diff_archives/` | Архивы изменений для скачивания и переноса |
| `webapp/data/` | SQLite БД (`npm-hub.db`) |
| `webapp/logs/` | Логи задач |

## Scope

Проект является полноценным автономным решением. Все компоненты работают в Docker-контейнерах.
